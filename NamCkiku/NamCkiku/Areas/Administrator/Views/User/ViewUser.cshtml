@model  List<Models.EF.User>
@{
    ViewBag.Title = "ViewUser";
    Layout = "~/Areas/Administrator/Views/Shared/_LayoutAdmin.cshtml";
    <link rel="stylesheet" href="~/Contents/Administrator/assets/data-tables/DT_bootstrap.css" />
}
<section class="wrapper site-min-height">
    <!-- page start-->
    <section class="panel">
        <header class="panel-heading">
            Quản Lý Tài Khoản
        </header>
        <div class="panel-body">
            <div class="adv-table editable-table ">
                <button type="button" id="create" class="btn btn-round btn-primary btn-md" data-toggle="modal" data-target="#mycreate">
                    <i class="fa fa-plus"></i>Thêm
                </button>
                <div class="space15"></div>
                <table class="table table-striped table-hover table-bordered" id="editable-sample">
                    <thead>
                        <tr>
                            <th class="text-center">
                                <span><input id="addBehaviorOnToastClick" type="checkbox" value="checked" class="input-small"></span>
                            </th>
                            <th class="text-center">Tài Khoản</th>
                            <th class="text-center">Họ Tên</th>
                            <th class="text-center">Email</th>
                            <th class="text-center">Ngày Đăng Ký</th>
                            <th class="text-center">Hoạt Động</th>
                            <th class="text-center">Chức Năng</th>
                        </tr>
                    </thead>
                    <tbody id="tbody">
                        @foreach (var item in Model)
                        {
                            <tr class="">
                                <td class="text-center"><span><input id=" addbehaviorontoastclick" type="checkbox" value="checked" class="input-small"></span></td>
                                <td class="text-center">@item.UserName</td>
                                <td class="text-center">@item.Name</td>
                                <td class="text-center">@item.Email</td>
                                <td class="text-center">@item.CreatedDate</td>
                                <td class="text-center">@item.Status</td>
                                <td class="text-center">
                                    <button type="button" id="btnupdate" data-id="@item.ID" class="btn btn-round btn-primary btn-xs btnupdate" data-toggle="modal" data-target="#myupdate">
                                        <i class="fa fa-pencil-square-o"></i>Sửa
                                    </button>
                                    <button type="button" id="btnDelete" data-id="@item.ID" class="btn btn-round btn-danger btn-xs btnDelete" data-toggle="modal" data-target="#mydelete">
                                        <i class="fa fa-trash-o"></i>Xóa
                                    </button>
                                </td>
                            </tr>
                        }
                    </tbody>
                    <tfoot>
                        <tr>
                            <td colspan="7">
                                <select class="form-control" name="action" id="action">
                                    <option value="delete">Xóa</option>
                                    <option value="publtime">Đăng sản phẩm</option>
                                    <option value="exptime">Cho hết hạn sản phẩm</option>
                                    <option value="addtoblock">Thêm sản phẩm vào block</option>
                                </select>
                                <input type="button" class="btn btn-primary" onclick="nv_main_action(this.form, '19561aa02ccb801383374446d09fc314','Bạn cần chọn ít nhất 1 sản phẩm để thực hiện')" value="Thực hiện">
                            </td>
                        </tr>
                    </tfoot>
                </table>
            </div>
        </div>
    </section>
    <div class="row">
        <div class="col-lg-offset-9 col-lg-3 ">
            <div id="alertBox" class='alert alert-danger hidden'>
                Thành Công
                <a href='#' class='close' data-dismiss='alert' aria-label='close' title='close'>×</a>
            </div>
        </div>
    </div>

    <!--Model-->
    <div class="modal fade bs-example-modal-lg" id="mycreate" role="dialog" aria-labelledby="myLargeModalLabel">
        <div class="modal-dialog modal-lg" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title" id="myModalLabel">Thêm Sản Phẩm</h4>
                </div>
                <div class="modal-body">
                    @*@{
                            Html.RenderAction("_CreateUser", "User");
                        }*@
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Đóng</button>
                    <button type="button" class="btn btn-primary" id="btnthem">Thêm</button>
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade bs-example-modal-lg" tabindex="-1" id="myupdate" role="dialog" aria-labelledby="myLargeModalLabel">
        <div class="modal-dialog modal-lg" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title" id="myModalLabel">Sửa Tài Khoản</h4>
                </div>
                <div class="modal-body model-update">
                    @*@{ Html.RenderAction("_UpdateUser", "User"); }*@
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Đóng</button>
                    <button type="button" class="btn btn-primary" id="btnedit">Lưu</button>
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade bs-example-modal-lg" tabindex="-1" id="mydelete" role="dialog" aria-labelledby="myLargeModalLabel">
        <div class="modal-dialog modal-lg" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title" id="myModalLabel">Xóa Tài Khoản</h4>
                </div>
                <div class="modal-body model-delete">
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Đóng</button>
                    <button type="button" class="btn btn-primary" id="btndelete">Lưu</button>
                </div>
            </div>
        </div>
    </div>
    <!-- page end-->
</section>
<!-- page start-->
@section Script
{
    <script type="text/javascript" src="~/Contents/Administrator/assets/data-tables/jquery.dataTables.js"></script>
    <script type="text/javascript" src="~/Contents/Administrator/assets/data-tables/DT_bootstrap.js"></script>
    <script src="~/Contents/Administrator/js/editable-table.js"></script>
    <!-- END JAVASCRIPTS -->
    <script>
        $(document).ready(function () {
            EditableTable.init();
        });
    </script>
    <script>
        //load form sửa
        $(".btnupdate").click(function () {
            $(".model-update").load("@Url.Action("_UpdateUser", "User")/" + $(this).data("id"));
        });

        //load form xóa
        $(".btnDelete").click(function () {
            $(".model-delete").load("@Url.Action("_DeleteUser", "User")/" + $(this).data("id"));
        });
        //load form thêm
        $("#create").click(function () {
            $(".modal-body").load("@Url.Action("_CreateUser", "User")");
        });
    </script>
    <script language="javascript">
        $("#btnthem").click(function () {
            var dataCreate = {
                UserName: $("#UserName").val(),
                Password: $("#Password").val(),
                Name: $("#Name").val(),
                Address: $("#Address").val(),
                Email: $("#Email").val(),
                Phone: $("#Phone").val(),
                Status: $("#Status").val(),
                CreatedDate: $("#CreatedDate").val(),
                CreatedBy: $("#CreatedBy").val(),
                ID: $("#ID").val(),
            }
            $.ajax({
                url: '@Url.Action("CreateUser", "User")',
                type: "post",
                data: dataCreate,
                success: function (data) {
                    $('#mycreate').modal('hide');
                    $('#alertBox').removeClass('hidden');
                    $('#alertBox').delay(2000).slideUp(500);
                    location.reload();
                }
            });
        });
    </script>
    <script language="javascript">
        $("#btnedit").click(function () {
            var dataUpdate = {
                id: $("#ID").val(),
                UserName: $("#UserName").val(),
                Password: $("#Password").val(),
                Name: $("#Name").val(),
                Address: $("#Address").val(),
                Email: $("#Email").val(),
                Phone: $("#Phone").val(),
                Status: $("#Status").val(),
            }
            $.ajax({
                url: '@Url.Action("UpdateUser", "User")',
                type: "post",
                data: dataUpdate,
                success: function () {
                    $('#myupdate').modal('hide');
                    $('#alertBox').removeClass('hidden');
                    $('#alertBox').delay(2000).slideUp(500);
                    location.reload();
                }
            });
        });
    </script>
    <script language="javascript">
        $("#btndelete").click(function () {
            var dataDelete = {
                id: $("#ID").val(),
            }
            $.ajax({
                url: '@Url.Action("DeleteUser", "User")',
                type: "post",
                data: dataDelete,
                success: function () {
                    $('#mydelete').modal('hide');
                    $('#alertBox').removeClass('hidden');
                    $('#alertBox').delay(2000).slideUp(500);
                    location.reload();
                }
            });
        });
    </script>
    @*<script type="text/javascript">
            function _getAll() {
                $.ajax({
                    url: '@Url.Action("ViewAll", "User")',
                    type: "GET",
                    contentType: "application/json; charset=utf-8",
                    dataType: "json",
                    success: function (result) {
                        var html = '';
                        $.each(result, function (key, item) {
                            html += '<tr>';
                            html += '<td class="text-center"><span><input id=" addbehaviorontoastclick" type="checkbox" value="checked" class="input-small"></span></td>';
                            html += '<td  class="text-center">' + item.UserName + '</td>';
                            html += '<td  class="text-center">' + item.Name + '</td>';
                            html += '<td  class="text-center">' + item.Email + '</td>';
                            html += '<td  class="text-center">' + item.CreatedDate + '</td>';
                            html += '<td  class="text-center">' + item.Status + '</td>';
                            html += '<td class="text-center">';
                            html += '<button type="button" id="btnupdate" data-id=' + item.ID + ' class="btn btn-round btn-primary btn-xs btnupdate" data-toggle="modal" data-target="#myupdate">';
                            html += '<i class="fa fa-pencil-square-o"></i>Sửa';
                            html += '</button>';
                            html += '<button type="button" id="btnDelete" data-id=' + item.ID + ' class="btn btn-round btn-danger btn-xs btnDelete" data-toggle="modal" data-target="#mydelete">';
                            html += '<i class="fa fa-trash-o"></i>Xóa';
                            html += '</button>';
                            html += '</td>';
                            html += '</tr>';
                        });
                        $('#tbody').html(html);
                    },
                });
                return false;
            }
        </script>*@
}



